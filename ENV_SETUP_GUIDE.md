# Environment Configuration Guide - AFE Frontend

## üìã Overview

This document explains the environment configuration strategy for the AFE Frontend application. It follows corporate best practices for managing environment-specific configurations across development, staging, and production environments.

---

## üéØ Configuration Files

### **`.env.example`** ‚úÖ [TRACKED IN GIT]
- **Purpose**: Template for developers and CI/CD pipelines
- **Contents**: Default/template values for all environments
- **Usage**: Reference file - copy to create environment-specific files
- **Visibility**: Public (safe to commit to git)

### **`.env`** ‚ùå [IGNORED BY GIT]
- **Purpose**: Local development configuration for each developer
- **Contents**: Developer's personal API URLs and settings
- **Usage**: Each developer creates/manages their own copy
- **Visibility**: Private (never commit)
- **Lifecycle**: Created once per machine, auto-generated by IDE on first run

### **`.env.staging`** ‚ùå [IGNORED BY GIT]
- **Purpose**: Staging environment configuration
- **Contents**: Staging API endpoints and settings
- **Usage**: Manual testing, staging deployment
- **Visibility**: Private (never commit - use CI/CD secrets instead)
- **Lifecycle**: Used for staging deployments via CI/CD

### **`.env.production`** ‚ùå [IGNORED BY GIT]
- **Purpose**: Production environment configuration
- **Contents**: Production API endpoints and settings
- **Usage**: Production deployment only
- **Visibility**: Private (must NEVER be committed)
- **Lifecycle**: Injected via CI/CD secrets at deployment time

---

## üîß Setup Instructions

### For Developers (First Time Setup)

1. **Clone the repository**
   ```bash
   git clone <repository-url>
   cd afe_frontend
   ```

2. **Copy the template to create local .env**
   ```bash
   cp .env.example .env
   ```

3. **Edit `.env` with your local settings**
   ```bash
   # .env
   VITE_API_URL=http://localhost:8000/api/v1
   VITE_API_TIMEOUT=30000
   VITE_ENVIRONMENT=development
   ```

4. **Install dependencies and run**
   ```bash
   npm install
   npm run dev
   ```

5. ‚úÖ Application will now load with your local configuration

### For Staging Deployment

1. **Ensure staging configuration is available**
   ```bash
   cat .env.staging
   ```

2. **Build with staging environment**
   ```bash
   npm run build -- --mode staging
   ```

3. **Verify staging API in built application**
   - Check network requests in browser DevTools
   - Confirm requests go to staging API endpoint

### For Production Deployment

1. **Production variables are injected via CI/CD secrets**
   - GitHub Actions: Uses repository secrets
   - GitLab CI: Uses CI/CD variables
   - Other: Use platform-specific secret management

2. **Do NOT commit `.env.production` to git**
   - This is a template only
   - Actual values come from CI/CD pipeline

3. **Verify deployment**
   - Check network requests in production
   - Monitor API calls to production endpoint

---

## üìù Environment Variables Reference

### Required Variables

| Variable | Type | Environment | Example |
|----------|------|-------------|---------|
| `VITE_API_URL` | String | All | `http://localhost:8000/api/v1` |

### Optional Variables

| Variable | Type | Default | Example |
|----------|------|---------|---------|
| `VITE_API_TIMEOUT` | Number | `30000` | `45000` |
| `VITE_ENVIRONMENT` | String | `development` | `staging`, `production` |

---

## üîê Security Best Practices

### ‚úÖ DO:
- ‚úÖ Commit `.env.example` to version control
- ‚úÖ Never commit `.env`, `.env.staging`, `.env.production` to git
- ‚úÖ Use HTTPS URLs for non-local environments
- ‚úÖ Rotate secrets in CI/CD regularly
- ‚úÖ Use CI/CD secrets for production values
- ‚úÖ Document all environment variables in `.env.example`
- ‚úÖ Use environment-specific API endpoints

### ‚ùå DON'T:
- ‚ùå Hardcode API URLs in source code
- ‚ùå Commit real API URLs/endpoints to git
- ‚ùå Share `.env` files via email or chat
- ‚ùå Use production values in development
- ‚ùå Expose private endpoints in logs
- ‚ùå Store secrets in comments
- ‚ùå Use same endpoint for all environments

---

## üöÄ CI/CD Integration

### GitHub Actions Example

```yaml
name: Deploy to Staging

on: [push]

env:
  VITE_API_URL: ${{ secrets.STAGING_API_URL }}
  VITE_API_TIMEOUT: ${{ secrets.API_TIMEOUT }}
  VITE_ENVIRONMENT: staging

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
      - run: npm install
      - run: npm run build
      - run: npm run deploy
```

### Docker Example

```dockerfile
# Dockerfile
FROM node:18-alpine

ARG VITE_API_URL
ARG VITE_ENVIRONMENT

ENV VITE_API_URL=$VITE_API_URL
ENV VITE_ENVIRONMENT=$VITE_ENVIRONMENT

WORKDIR /app
COPY . .
RUN npm install
RUN npm run build

EXPOSE 3000
CMD ["npm", "run", "preview"]
```

---

## üîç Troubleshooting

### Issue: API calls go to localhost in production
**Solution**: Check that correct `.env.production` values are loaded in CI/CD

### Issue: Different API URL per developer
**Solution**: Each developer has their own `.env` - this is expected

### Issue: "Cannot find .env file" error
**Solution**: Create `.env` by copying `.env.example`: `cp .env.example .env`

### Issue: Environment variable not loading
**Solution**: Ensure variable starts with `VITE_` for frontend visibility

### Issue: Changes to .env not reflecting
**Solution**: Restart dev server: `npm run dev`

---

## üìö Related Files

- [.env.example](./.env.example) - Template for all environments
- [.gitignore](./.gitignore) - Git ignore rules for .env files
- [src/services/api.ts](./src/services/api.ts) - API client configuration
- [vite.config.ts](./vite.config.ts) - Vite configuration

---

## üë§ Author & Support

- **Created**: 2025-11-07
- **Modified by**: Senior Developer
- **Support**: Contact DevOps team for environment configuration issues

---

## ‚úÖ Checklist

- [ ] `.env.example` is committed to git
- [ ] `.env` is created locally and matches `.env.example` structure
- [ ] `.gitignore` prevents `.env` files from being committed
- [ ] `VITE_API_URL` matches your local backend URL
- [ ] Application loads without environment errors
- [ ] Network requests in DevTools show correct API endpoint
- [ ] CI/CD secrets are configured for staging/production

---

**Last Updated**: 2025-11-07
**Version**: 1.0.0
**Status**: ‚úÖ Production Ready
